<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Panel Staff - Escuadrón X</title>

<style>
    body { background: #000; color: white; font-family: Arial; }
    h1 { text-align: center; color: #ff0000; }
    .login-box, .panel {
        max-width: 700px; margin: auto; background: #111;
        padding: 20px; border-radius: 10px; border: 1px solid #333;
        margin-top: 40px;
    }
    input {
        width: 100%; padding: 10px; margin-top: 10px;
        border-radius: 5px; border: none; background: #222; color: white;
    }
    button {
        margin-top: 15px; padding: 10px 20px; background: #ff0000;
        border: none; border-radius: 5px; cursor: pointer;
    }
    button:hover { background: #cc0000; }
    .postulacion {
        background: #222; padding: 15px; border-radius: 8px;
        margin-top: 15px; border: 1px solid #444;
    }
    .estado { font-weight: bold; }
    .btn-aceptar { background: #00aa00; }
    .btn-rechazar { background: #aa0000; }
</style>
</head>

<body>

<h1>Panel de Postulaciones - Escuadrón X</h1>

<!-- LOGIN -->
<div class="login-box" id="loginBox">
    <h2>Acceso Staff</h2>
    <input type="password" id="password" placeholder="Contraseña">
    <button onclick="login()">Entrar</button>
</div>

<!-- PANEL -->
<div class="panel" id="panel" style="display:none;">
    <h2>Postulaciones</h2>

    <label>Filtrar por estado:</label>
    <select id="filtro" onchange="cargarPostulaciones()">
        <option value="todos">Todos</option>
        <option value="En revisión">En revisión</option>
        <option value="Aceptado">Aceptados</option>
        <option value="Rechazado">Rechazados</option>
    </select>

    <div id="lista"></div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js"></script>

<script>
const firebaseConfig = {
    apiKey: "AIzaSyA22O0m0Z1vkHvElYmOpe4vZvrC3EsPyzU",
    authDomain: "escuadronx.firebaseapp.com",
    projectId: "escuadronx",
    storageBucket: "escuadronx.firebasestorage.app",
    messagingSenderId: "29439561906",
    appId: "1:29439561906:web:472dba0628860609d539ab"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
</script>

<script>
// LOGIN
function login() {
    const pass = document.getElementById("password").value;
    if (pass === "EscuadronX2025") {
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("panel").style.display = "block";
        cargarPostulaciones();
    } else {
        alert("Contraseña incorrecta");
    }
}

// CARGAR POSTULACIONES
async function cargarPostulaciones() {
    const filtro = document.getElementById("filtro").value;
    const lista = document.getElementById("lista");
    lista.innerHTML = "";

    const snapshot = await db.collection("postulaciones").get();

    snapshot.forEach(doc => {
        const data = doc.data();

        if (filtro !== "todos" && data.estado !== filtro) return;

        const div = document.createElement("div");
        div.className = "postulacion";

        div.innerHTML = `
            <p><strong>Nombre:</strong> ${data.nombre}</p>
            <p><strong>Discord:</strong> ${data.discord}</p>
            <p><strong>Puesto:</strong> ${data.puesto}</p>
            <p><strong>Motivo:</strong> ${data.motivo}</p>
            <p><strong>Estado:</strong> <span class="estado">${data.estado}</span></p>
            <button class="btn-aceptar" onclick="actualizarEstado('${doc.id}', 'Aceptado')">Aceptar</button>
            <button class="btn-rechazar" onclick="actualizarEstado('${doc.id}', 'Rechazado')">Rechazar</button>
        `;

        lista.appendChild(div);
    });
}

// ACTUALIZAR ESTADO
async function actualizarEstado(id, nuevoEstado) {
    await db.collection("postulaciones").doc(id).update({
        estado: nuevoEstado
    });

    cargarPostulaciones();
}
</script>

</body>
</html>
